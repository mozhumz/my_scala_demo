package com.hyj.spark.CF


import com.alibaba.fastjson.{JSON, JSONArray}
import org.apache.spark.sql.{DataFrame, SparkSession}
import org.apache.spark.sql.functions._
import org.apache.spark.sql._
import org.apache.spark.sql.Row
import scala.collection.mutable


/**
  * sparksql-userCF 基于相似用户-获取推荐物品
  */
object UserBaseHyj {
  def main(args: Array[String]): Unit = {
    val spark: SparkSession = SparkSession.builder().master("local[*]")
      .appName("sparksql-userCF").enableHiveSupport()
      .getOrCreate()

    val df = spark.sql("select user_id,item_id,cast(rating as double) as rating  from badou.udata")

//        df.show()
    /**
      * |user_id|item_id|rating|
      * +-------+-------+------+
      * |    196|    242|     3|
      * |    186|    302|     3|
      * |     22|    377|     1|
      */

    /**
      * 1 计算用户相似度 这里使用cosine=a*b/(|a|*|b|)
      */
      //计算|a| |b|
    val u_df_abs = df.selectExpr("*", "pow(rating,2) as pow_rating").groupBy("user_id").agg(sum("pow_rating").as("pow_sum")) .selectExpr("user_id", "sqrt(pow_sum) as u_abs")
    //      .show()
    /**
      * -------+------------------+
      * |user_id|             u_abs|
      * +-------+------------------+
      * |    296|52.630789467763066|
      * |    467| 25.25866188063018|
      * |    691| 24.71841418861655|
      */
    val v_df_abs = u_df_abs.selectExpr("user_id as user_id_v","u_abs as u_abs_v")
    //计算 a*b
    val v_df = df.selectExpr("user_id as user_id_v","item_id","rating as rating_v")
    val dot_df = df.join(v_df, "item_id").filter("user_id!=user_id_v") .selectExpr("*", "(rating * rating_v) as dot").groupBy("user_id", "user_id_v").agg(sum("dot").as("dot_sum"))
    //      .show()
    /**
      * +-------+---------+--------+
      * |user_id|user_id_v|dot_sum|
      * +-------+---------+--------+
      * |    196|      617|    24.0|
      * |    196|      123|    71.0|
      * |    166|      206|   104.0|
      */

    val u_v_cos_df = dot_df.join(u_df_abs, "user_id").join(v_df_abs, "user_id_v") .selectExpr("user_id", "user_id_v", "dot_sum/(u_abs*u_abs_v) as cos")
//      .show()
    /**
      * +-------+---------+--------------------+
      * |user_id|user_id_v|                 cos|
      * +-------+---------+--------------------+
      * |    196|      617|0.033533914107330615|
      * |    196|      123| 0.10297059695164824|
      * |    166|      206| 0.29163935315828643|
      */

    //取top-N的相似用户
    import spark.implicits._
    val top_cos_df = u_v_cos_df.rdd.map(x => (x(0).toString, (x(1).toString, x(2).toString))).groupByKey().mapValues(v => v.toArray.sortWith((v1, v2) => v1._2.toDouble.compareTo(v2._2.toDouble) > 0).slice(0, 5))

      /**
        * +-------+------------------------------------------------------------------------------------------------------------------------------------------+
        * |user_id|cos_v                                                                                                                                     |
        * +-------+------------------------------------------------------------------------------------------------------------------------------------------+
        * |385    |[[308, 0.49966117411717703], [833, 0.49490993620255647], [561, 0.4894204693024517], [747, 0.48914371760013464], [269, 0.4861011288308306]]|
        * |547    |[[111, 0.61757054089566], [820, 0.5468120033460924], [112, 0.5446384268877663], [284, 0.5271047230630211], [273, 0.5194974338578282]]     |
        * |709    |[[586, 0.5766019014551587], [37, 0.5530764637005143], [757, 0.5356752636320219], [222, 0.5196962518063857], [442, 0.5158462257733791]]    |
        */
      .flatMapValues(v => v) .toDF("user_id", "cos_v") .selectExpr("user_id", "cos_v._1 as user_id_v", "cos_v._2 as cos")
//      .show(false)
    /**
      * |user_id|user_id_v|cos                |
      * +-------+---------+-------------------+
      * |385    |308      |0.49966117411717703|
      * |385    |833      |0.49490993620255647|
      * |385    |561      |0.4894204693024517 |
      */

    /**
      * 2 根据相似用户计算推荐物品
      */

    val u_item_df = df.rdd.map(x => (x(0).toString, (x(1).toString, x(2).toString))).groupByKey() .mapValues(v => v.toArray).toDF("user_id", "arr_val")
//      .show(false)
    /**
      * |user_id|arr_val                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
      * +-------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      * |273    |[[328, 3.0], [345, 3.0], [311, 4.0], [902, 5.0], [900, 3.0], [690, 4.0], [319, 4.0], [321, 4.0], [303, 4.0], [305, 4.0], [315, 4.0], [316, 4.0], [340, 3.0], [272, 4.0], [347, 4.0], [313, 3.0], [304, 3.0], [307, 2.0], [286, 3.0], [268, 5.0], [896, 4.0], [338, 3.0]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
      * |528    |[[485, 2.0], [239, 5.0], [58, 5.0], [358, 2.0], [751, 4.0], [748, 3.0], [423, 1.0], [193, 4.0], [310, 3.0], [479, 4.0], [393, 2.0], [657, 5.0], [82, 4.0], [50, 5.0], [238, 3.0], [194, 5.0], [174, 5.0], [181, 5.0], [523, 4.0], [615, 4.0], [178, 4.0], [484, 3.0], [588, 2.0], [298, 4.0], [402, 4.0], [210, 5.0], [185, 4.0], [505, 4.0], [168, 4.0], [203, 4.0], [56, 3.0], [109, 4.0], [77, 3.0], [173, 5.0], [69, 3.0], [1618, 1.0], [83, 5.0], [294, 3.0], [541, 3.0], [31, 5.0], [427, 4.0], [258, 4.0], [845, 3.0], [204, 5.0], [526, 4.0], [422, 2.0], [202, 5.0], [250, 3.0], [79, 5.0], [1254, 3.0], [213, 4.0], [678, 3.0], [410, 4.0]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
      */

    val v_item_df = u_item_df.selectExpr("user_id as user_id_v","arr_val as arr_val_v")

    /**
      * 3 根据相似度和推荐物品计算物品打分
      */
    val score_df = top_cos_df.join(u_item_df, "user_id").join(v_item_df, "user_id_v")
      .selectExpr("user_id", "user_id_v", "cos", "arr_val", "arr_val_v")
//    score_df.rdd.map(x=>{val arr_val = classOf[mutable.WrappedArray[String]].cast(x(3));val arr_val_v = classOf[mutable.WrappedArray[String]].cast(x(4)); (x(3).toString,x(4).toString)}).toDF().show()
    score_df .rdd.map(x=>{
//      val arr_val = classOf[mutable.WrappedArray[Any]].cast(x(3))
//      val arr_val_v = classOf[mutable.WrappedArray[Any]].cast(x(4))
      val array = x.getAs[Array[Any]](3)
//      //用户u中的item去重
      val map = Map[String,String]()
      array.map(arr=>
        {
//          val string: String = arr(0)
////        todo 如何将arr转为数组
        }
        )
      (x(0).toString,x(1).toString)
      }).toDF("x0","x1")
      .show(false)

    /**
      * +---------+-------+-------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      * |user_id_v|user_id|cos                |arr_val                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |arr_val_v                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
      * +---------+-------+-------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      * |296      |71     |0.33828954632615976|[[89, 5.0], [134, 3.0], [346, 4.0], [285, 3.0], [462, 5.0], [475, 5.0], [222, 3.0], [56, 5.0], [923, 5.0], [276, 4.0], [289, 2.0], [151, 1.0], [65, 5.0], [50, 3.0], [135, 4.0], [154, 3.0], [64, 4.0], [257, 5.0], [175, 4.0], [197, 5.0], [357, 5.0], [248, 3.0], [181, 3.0], [14, 5.0], [282, 3.0], [174, 2.0], [429, 4.0], [177, 2.0], [744, 4.0], [514, 4.0], [286, 4.0], [52, 4.0], [302, 3.0], [168, 5.0], [153, 4.0], [98, 4.0], [100, 4.0], [6, 3.0]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |[[705, 5.0], [508, 5.0], [20, 5.0], [228, 4.0], [222, 5.0], [429, 5.0], [855, 5.0], [248, 5.0], [258, 5.0], [242, 4.0], [48, 5.0], [286, 5.0], [272, 5.0], [510, 5.0], [275, 4.0], [427, 5.0], [83, 5.0], [961, 5.0], [544, 4.0], [32, 4.0], [1009, 3.0], [1073, 5.0], [96, 5.0], [292, 5.0], [950, 4.0], [1142, 5.0], [654, 5.0], [948, 1.0], [279, 4.0], [685, 4.0], [255, 2.0], [15, 3.0], [455, 1.0], [98, 5.0], [10, 2.0], [277, 5.0], [238, 4.0], [485, 5.0], [846, 2.0], [172, 5.0], [281, 2.0], [151, 2.0], [14, 4.0], [750, 5.0], [484, 4.0], [298, 1.0], [210, 3.0], [22, 4.0], [504, 5.0], [923, 5.0], [56, 5.0], [274, 4.0], [475, 4.0], [124, 5.0], [963, 5.0], [204, 5.0], [117, 3.0], [815, 3.0], [845, 5.0], [121, 5.0], [482, 5.0], [284, 4.0], [24, 2.0], [179, 4.0], [240, 1.0], [45, 5.0], [309, 1.0], [268, 4.0], [134, 5.0], [652, 4.0], [89, 5.0], [269, 5.0], [435, 5.0], [191, 5.0], [521, 4.0], [257, 5.0], [357, 5.0], [55, 5.0], [287, 4.0], [198, 5.0], [293, 5.0], [100, 5.0], [125, 5.0], [259, 1.0], [663, 5.0], [79, 4.0], [523, 4.0], [180, 5.0], [303, 4.0], [61, 3.0], [199, 5.0], [528, 5.0], [294, 1.0], [237, 5.0], [251, 5.0], [515, 5.0], [144, 4.0], [1160, 4.0], [282, 4.0], [1284, 4.0], [688, 1.0], [111, 3.0], [304, 3.0], [289, 3.0], [186, 3.0], [221, 5.0], [480, 5.0], [127, 5.0], [628, 5.0], [313, 5.0], [1007, 4.0], [50, 5.0], [256, 5.0], [19, 5.0], [297, 4.0], [301, 5.0], [315, 5.0], [1, 5.0], [7, 5.0], [181, 5.0], [483, 5.0], [11, 5.0], [114, 5.0], [285, 5.0], [211, 4.0], [276, 5.0], [9, 4.0], [13, 3.0], [244, 1.0], [632, 5.0], [194, 5.0], [469, 5.0], [250, 2.0], [153, 4.0], [898, 4.0], [150, 1.0], [246, 4.0], [514, 5.0], [659, 5.0], [462, 4.0], [696, 4.0], [1251, 5.0], [187, 5.0], [498, 5.0], [23, 5.0], [209, 4.0], [137, 4.0]]                                                                                                                                                                                                                                                                                                                                                                                                                                           |
      * |296      |753    |0.3968472894511972 |[[673, 1.0], [79, 4.0], [898, 4.0], [515, 5.0], [96, 1.0], [359, 4.0], [182, 3.0], [484, 5.0], [483, 5.0], [510, 4.0], [499, 3.0], [462, 4.0], [50, 4.0], [199, 5.0], [194, 4.0], [215, 5.0], [22, 4.0], [211, 4.0], [322, 3.0], [134, 4.0], [195, 1.0], [504, 3.0], [180, 2.0], [23, 2.0], [435, 4.0], [294, 5.0], [527, 4.0], [242, 4.0], [286, 3.0], [347, 2.0], [71, 5.0], [185, 3.0], [181, 3.0], [427, 5.0], [357, 4.0], [657, 5.0], [523, 4.0], [174, 4.0], [272, 4.0], [750, 2.0], [98, 5.0], [64, 4.0], [313, 5.0], [304, 4.0], [69, 4.0], [173, 5.0], [653, 4.0], [187, 3.0], [316, 4.0], [269, 5.0], [328, 3.0], [183, 1.0], [89, 3.0], [300, 1.0], [172, 3.0], [179, 2.0], [193, 4.0]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |[[705, 5.0], [508, 5.0], [20, 5.0], [228, 4.0], [222, 5.0], [429, 5.0], [855, 5.0], [248, 5.0], [258, 5.0], [242, 4.0], [48, 5.0], [286, 5.0], [272, 5.0], [510, 5.0], [275, 4.0], [427, 5.0], [83, 5.0], [961, 5.0], [544, 4.0], [32, 4.0], [1009, 3.0], [1073, 5.0], [96, 5.0], [292, 5.0], [950, 4.0], [1142, 5.0], [654, 5.0], [948, 1.0], [279, 4.0], [685, 4.0], [255, 2.0], [15, 3.0], [455, 1.0], [98, 5.0], [10, 2.0], [277, 5.0], [238, 4.0], [485, 5.0], [846, 2.0], [172, 5.0], [281, 2.0], [151, 2.0], [14, 4.0], [750, 5.0], [484, 4.0], [298, 1.0], [210, 3.0], [22, 4.0], [504, 5.0], [923, 5.0], [56, 5.0], [274, 4.0], [475, 4.0], [124, 5.0], [963, 5.0], [204, 5.0], [117, 3.0], [815, 3.0], [845, 5.0], [121, 5.0], [482, 5.0], [284, 4.0], [24, 2.0], [179, 4.0], [240, 1.0], [45, 5.0], [309, 1.0], [268, 4.0], [134, 5.0], [652, 4.0], [89, 5.0], [269, 5.0], [435, 5.0], [191, 5.0], [521, 4.0], [257, 5.0], [357, 5.0], [55, 5.0], [287, 4.0], [198, 5.0], [293, 5.0], [100, 5.0], [125, 5.0], [259, 1.0], [663, 5.0], [79, 4.0], [523, 4.0], [180, 5.0], [303, 4.0], [61, 3.0], [199, 5.0], [528, 5.0], [294, 1.0], [237, 5.0], [251, 5.0], [515, 5.0], [144, 4.0], [1160, 4.0], [282, 4.0], [1284, 4.0], [688, 1.0], [111, 3.0], [304, 3.0], [289, 3.0], [186, 3.0], [221, 5.0], [480, 5.0], [127, 5.0], [628, 5.0], [313, 5.0], [1007, 4.0], [50, 5.0], [256, 5.0], [19, 5.0], [297, 4.0], [301, 5.0], [315, 5.0], [1, 5.0], [7, 5.0], [181, 5.0], [483, 5.0], [11, 5.0], [114, 5.0], [285, 5.0], [211, 4.0], [276, 5.0], [9, 4.0], [13, 3.0], [244, 1.0], [632, 5.0], [194, 5.0], [469, 5.0], [250, 2.0], [153, 4.0], [898, 4.0], [150, 1.0], [246, 4.0], [514, 5.0], [659, 5.0], [462, 4.0], [696, 4.0], [1251, 5.0], [187, 5.0], [498, 5.0], [23, 5.0], [209, 4.0], [137, 4.0]]                                                                                                                                                                                                                                                                                                                                                                                                                                           |
      */


    /**
      * 排序取top-N 推荐user_id=71的物品
      */


  }
}
